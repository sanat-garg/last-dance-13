<!DOCTYPE html>
<html lang="en">
<head>
<script>
window.attachments = {
  'file-0': `data:@file/csv;base64,TnVtZXJpYyxOdW1lcmljLTIsTnVtZXJpYy1TdWZmaXgKMSwwMSwxc3QKMiwwMiwybmQKMywwMywzcmQKNCwwNCw0dGgKNSwwNSw1dGgKNiwwNiw2dGgKNywwNyw3dGgKOCwwOCw4dGgKOSwwOSw5dGgKMTAsMTAsMTB0aAoxMSwxMSwxMXRoCjEyLDEyLDEydGgKMTMsMTMsMTN0aAoxNCwxNCwxNHRoCjE1LDE1LDE1dGgKMTYsMTYsMTZ0aAoxNywxNywxN3RoCjE4LDE4LDE4dGgKMTksMTksMTl0aAoyMCwyMCwyMHRoCjIxLDIxLDIxc3QKMjIsMjIsMjJuZAoyMywyMywyM3JkCjI0LDI0LDI0dGgKMjUsMjUsMjV0aAoyNiwyNiwyNnRoCjI3LDI3LDI3dGgKMjgsMjgsMjh0aAoyOSwyOSwyOXRoCjMwLDMwLDMwdGgKMzEsMzEsMzFzdA==`,
};
</script>

<style>
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f4f4f4;
    color: #333;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
}

.container {
    width: 80%;
    max-width: 800px;
    margin: 20px;
    padding: 20px;
    background-color: #fff;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    border-radius: 8px;
}

img {
    max-width: 100%;
    height: auto;
    display: block;
    margin: 20px auto;
}

table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
}

th, td {
    border: 1px solid #ddd;
    padding: 8px;
    text-align: left;
}

th {
    background-color: #f2f2f2;
}

/* Responsive Design */
@media (max-width: 600px) {
    .container {
        width: 95%;
        margin: 10px;
        padding: 10px;
    }

    th, td {
        padding: 6px;
        font-size: 0.9em;
    }
}
</style>
</head>
<body>
<div class="container">
  <div id="image-container">
    <img id="display-image" src="" alt="Display Image">
  </div>
  <div id="csv-table-container">
    <table id="csv-table"></table>
  </div>
</div>

<script>
function loadImage(dataURI, elementId) {
    const imgElement = document.getElementById(elementId);
    imgElement.src = dataURI;
}

function createTableFromCSV(csvData, tableId) {
    const table = document.getElementById(tableId);
    table.innerHTML = ''; // Clear existing table

    const lines = csvData.split('\n');
    const headers = lines[0].split(',');

    // Create table header
    const thead = table.createTHead();
    const headerRow = thead.insertRow();
    headers.forEach(headerText => {
        const th = document.createElement('th');
        th.textContent = headerText;
        headerRow.appendChild(th);
    });

    // Create table body
    const tbody = table.createTBody();
    for (let i = 1; i < lines.length; i++) {
        const values = lines[i].split(',');
        const row = tbody.insertRow();

        values.forEach(value => {
            const td = document.createElement('td');
            td.textContent = value;
            row.appendChild(td);
        });
    }
}


// Load image if 'file-0' exists and is an image
if (window.attachments && window.attachments['file-0'] && window.attachments['file-0'].startsWith('data:image')) {
    loadImage(window.attachments['file-0'], 'display-image');
} else {
  //If there's no image hide the container
  document.getElementById('image-container').style.display = 'none';
}

// Load CSV data if 'file-0' exists and is a CSV
if (window.attachments && window.attachments['file-0'] && window.attachments['file-0'].startsWith('data:@file/csv')) {
    const csvData = atob(window.attachments['file-0'].split(',')[1]);
    createTableFromCSV(csvData, 'csv-table');
} else {
    const tableContainer = document.getElementById('csv-table-container');
    tableContainer.textContent = 'No CSV data available.';
}


</script>
</body>
</html>